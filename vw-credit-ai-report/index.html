<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§ä¼—æ±½è½¦é‡‘è - AIä¿¡å®¡æŠ¥å‘Šç³»ç»Ÿ</title>
    
    <!-- æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/report.css">
    <link rel="stylesheet" href="css/print.css" media="print">
    
    <!-- Vue.js 3.x CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- ECharts 5.x CDN -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    
    <!-- jsPDF CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- html2canvas CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- é¡¶éƒ¨å·¥å…·æ  -->
        <div class="toolbar" v-if="!isPrinting">
            <div class="toolbar-left">
                <img src="assets/logo.png" alt="å¤§ä¼—æ±½è½¦é‡‘è" class="logo" onerror="this.style.display='none'">
                <h1>AIä¿¡å®¡æŠ¥å‘Šç³»ç»Ÿ</h1>
            </div>
            <div class="toolbar-right">
                <select v-model="selectedCase" @change="loadCase" class="case-selector">
                    <option value="case1">æ¡ˆä¾‹1 - ä¼˜è´¨å®¢æˆ·(Açº§)</option>
                    <option value="case2">æ¡ˆä¾‹2 - è‰¯å¥½å®¢æˆ·(Bçº§)</option>
                    <option value="case3">æ¡ˆä¾‹3 - ä¸€èˆ¬å®¢æˆ·(Cçº§)</option>
                    <option value="case4">æ¡ˆä¾‹4 - å…³æ³¨å®¢æˆ·(Dçº§)</option>
                    <option value="case5">æ¡ˆä¾‹5 - æ‹’ç»å®¢æˆ·(Eçº§)</option>
                </select>
                <button @click="printReport" class="btn btn-secondary">
                    <span class="icon">ğŸ–¨ï¸</span> æ‰“å°æŠ¥å‘Š
                </button>
                <button @click="exportPDF" class="btn btn-primary">
                    <span class="icon">ğŸ“„</span> å¯¼å‡ºPDF
                </button>
            </div>
        </div>

        <!-- åŠ è½½åŠ¨ç”» -->
        <div v-if="loading" class="loading-overlay">
            <div class="loading-spinner"></div>
            <p>æ­£åœ¨ç”ŸæˆAIä¿¡å®¡æŠ¥å‘Š...</p>
        </div>

        <!-- ä¸»æŠ¥å‘Šå†…å®¹ -->
        <div class="report-container" id="report-content" v-show="!loading">
            <!-- æŠ¥å‘Šå¤´éƒ¨ -->
            <div class="report-header">
                <div class="header-left">
                    <div class="logo-placeholder">VW</div>
                    <div class="header-title">
                        <h2>å¤§ä¼—æ±½è½¦é‡‘è</h2>
                        <p>AIæ™ºèƒ½ä¿¡å®¡æŠ¥å‘Š</p>
                    </div>
                </div>
                <div class="header-right">
                    <div class="report-meta">
                        <p><strong>æŠ¥å‘Šæ—¥æœŸï¼š</strong>{{ reportDate }}</p>
                        <p><strong>æŠ¥å‘Šç¼–å·ï¼š</strong>{{ reportNumber }}</p>
                    </div>
                </div>
            </div>

            <!-- å®¢æˆ·æ¦‚è§ˆ -->
            <div class="report-section customer-overview">
                <h3 class="section-title">
                    <span class="icon">ğŸ‘¤</span> å®¢æˆ·æ¦‚è§ˆ
                </h3>
                <div class="overview-grid">
                    <div class="overview-item">
                        <label>å§“åï¼š</label>
                        <span>{{ customer.name }}</span>
                    </div>
                    <div class="overview-item">
                        <label>æ€§åˆ«ï¼š</label>
                        <span>{{ customer.gender }}</span>
                    </div>
                    <div class="overview-item">
                        <label>å¹´é¾„ï¼š</label>
                        <span>{{ customer.age }}å²</span>
                    </div>
                    <div class="overview-item">
                        <label>ç”³è¯·äº§å“ï¼š</label>
                        <span>{{ customer.product }}</span>
                    </div>
                    <div class="overview-item">
                        <label>ç”³è¯·é‡‘é¢ï¼š</label>
                        <span class="highlight">Â¥{{ formatNumber(customer.amount) }}</span>
                    </div>
                    <div class="overview-item">
                        <label>è´·æ¬¾æœŸé™ï¼š</label>
                        <span>{{ customer.term }}æœŸ</span>
                    </div>
                    <div class="overview-item full-width">
                        <label>è½¦å‹ï¼š</label>
                        <span>{{ customer.vehicle }}</span>
                    </div>
                </div>
            </div>

            <!-- é£é™©è¯„ä¼°å’Œå…³é”®æŒ‡æ ‡ -->
            <div class="report-section risk-assessment-section">
                <div class="risk-left">
                    <h3 class="section-title">
                        <span class="icon">âš ï¸</span> é£é™©è¯„ä¼°
                    </h3>
                    <div class="risk-score-container">
                        <div class="risk-score" :class="'risk-level-' + riskAssessment.level">
                            <div class="score-value">{{ riskAssessment.score }}</div>
                            <div class="score-label">ç»¼åˆè¯„åˆ†</div>
                            <div class="risk-level">{{ getRiskLevelText(riskAssessment.level) }}</div>
                        </div>
                    </div>
                    <div class="risk-radar" id="riskRadar"></div>
                </div>
                <div class="risk-right">
                    <h3 class="section-title">
                        <span class="icon">ğŸ“Š</span> å…³é”®æŒ‡æ ‡
                    </h3>
                    <div class="indicators-list">
                        <div class="indicator-item">
                            <div class="indicator-label">
                                <span>å€ºåŠ¡æ”¶å…¥æ¯” (DSR)</span>
                                <span class="indicator-value">{{ keyIndicators.dsr }}%</span>
                            </div>
                            <div class="indicator-bar">
                                <div class="indicator-fill" :style="{width: keyIndicators.dsr + '%'}" 
                                     :class="getIndicatorClass('dsr', keyIndicators.dsr)"></div>
                            </div>
                        </div>
                        <div class="indicator-item">
                            <div class="indicator-label">
                                <span>è´·æ¬¾ä»·å€¼æ¯” (LTV)</span>
                                <span class="indicator-value">{{ keyIndicators.ltv }}%</span>
                            </div>
                            <div class="indicator-bar">
                                <div class="indicator-fill" :style="{width: keyIndicators.ltv + '%'}"
                                     :class="getIndicatorClass('ltv', keyIndicators.ltv)"></div>
                            </div>
                        </div>
                        <div class="indicator-item">
                            <div class="indicator-label">
                                <span>æœˆæ”¶å…¥</span>
                                <span class="indicator-value">Â¥{{ formatNumber(keyIndicators.monthlyIncome) }}</span>
                            </div>
                        </div>
                        <div class="indicator-item">
                            <div class="indicator-label">
                                <span>å¾ä¿¡è¯„åˆ†</span>
                                <span class="indicator-value">{{ keyIndicators.creditScore }}</span>
                            </div>
                        </div>
                        <div class="indicator-item">
                            <div class="indicator-label">
                                <span>é€¾æœŸæ¬¡æ•°</span>
                                <span class="indicator-value" :class="keyIndicators.overdueCount > 0 ? 'text-danger' : 'text-success'">
                                    {{ keyIndicators.overdueCount }}æ¬¡
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RAGæ™ºèƒ½ä¿¡æ¯æ±‡æ€» -->
            <div class="report-section rag-summary">
                <h3 class="section-title">
                    <span class="icon">ğŸ¤–</span> AIæ™ºèƒ½ä¿¡æ¯æ±‡æ€» <span class="badge">RAGæŠ€æœ¯</span>
                </h3>
                <div class="rag-grid">
                    <div class="rag-item">
                        <div class="rag-icon">ğŸ“Š</div>
                        <div class="rag-content">
                            <strong>è´¢æŠ¥æ‘˜è¦ï¼š</strong>
                            <p>{{ ragSummary.financial }}</p>
                        </div>
                    </div>
                    <div class="rag-item">
                        <div class="rag-icon">ğŸ”</div>
                        <div class="rag-content">
                            <strong>ç¬¬ä¸‰æ–¹æ•°æ®ï¼š</strong>
                            <p>{{ ragSummary.thirdParty }}</p>
                        </div>
                    </div>
                    <div class="rag-item">
                        <div class="rag-icon">ğŸ“°</div>
                        <div class="rag-content">
                            <strong>èˆ†æƒ…ç›‘æµ‹ï¼š</strong>
                            <p>{{ ragSummary.sentiment }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AIå»ºè®®å®¡æ ¸æ–¹å‘ -->
            <div class="report-section ai-recommendations">
                <h3 class="section-title">
                    <span class="icon">ğŸ¯</span> AIå»ºè®®å®¡æ ¸æ–¹å‘
                </h3>
                <div class="recommendations-list">
                    <div v-for="(direction, index) in aiRecommendations.directions" 
                         :key="index" 
                         class="recommendation-item"
                         :class="'priority-' + direction.priority">
                        <div class="recommendation-number">{{ index + 1 }}</div>
                        <div class="recommendation-content">
                            <p>{{ direction.text }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å®¡æ‰¹å»ºè®® -->
            <div class="report-section approval-recommendation">
                <h3 class="section-title">
                    <span class="icon">âœ…</span> å®¡æ‰¹å»ºè®®
                </h3>
                <div class="approval-grid">
                    <div class="approval-item decision" :class="'decision-' + recommendation.decision">
                        <label>å»ºè®®å†³ç­–ï¼š</label>
                        <span class="decision-badge">{{ getDecisionText(recommendation.decision) }}</span>
                    </div>
                    <div class="approval-item">
                        <label>å»ºè®®é¢åº¦ï¼š</label>
                        <span>Â¥{{ formatNumber(recommendation.loanAmountMin) }} - Â¥{{ formatNumber(recommendation.loanAmountMax) }}</span>
                    </div>
                    <div class="approval-item">
                        <label>å»ºè®®åˆ©ç‡ï¼š</label>
                        <span>{{ recommendation.interestRateMin }}% - {{ recommendation.interestRateMax }}%</span>
                    </div>
                    <div class="approval-item">
                        <label>é¢„æœŸè¿çº¦ç‡ï¼š</label>
                        <span :class="recommendation.defaultProbability > 5 ? 'text-danger' : 'text-success'">
                            {{ recommendation.defaultProbability }}%
                        </span>
                    </div>
                </div>
                <div v-if="recommendation.conditions && recommendation.conditions.length > 0" class="approval-conditions">
                    <strong>é™„åŠ æ¡ä»¶ï¼š</strong>
                    <ul>
                        <li v-for="(condition, index) in recommendation.conditions" :key="index">
                            {{ condition }}
                        </li>
                    </ul>
                </div>
            </div>

            <!-- AIè¾…åŠ©æé—® -->
            <div class="report-section ai-questions">
                <h3 class="section-title" @click="toggleQuestions" style="cursor: pointer;">
                    <span class="icon">ğŸ’¬</span> AIè¾…åŠ©æé—®
                    <span class="toggle-icon">{{ showQuestions ? 'â–¼' : 'â–¶' }}</span>
                    <span class="question-count">({{ aiRecommendations.questions.length }}ä¸ªå»ºè®®é—®é¢˜)</span>
                </h3>
                <div v-show="showQuestions" class="questions-list">
                    <div v-for="(question, index) in aiRecommendations.questions" 
                         :key="index" 
                         class="question-item">
                        <div class="question-header">
                            <span class="question-category">{{ question.category }}</span>
                            <span class="question-priority" :class="'priority-' + question.priority">
                                ä¼˜å…ˆçº§{{ question.priority }}
                            </span>
                        </div>
                        <div class="question-content">
                            <strong>Q{{ index + 1 }}:</strong> {{ question.question }}
                        </div>
                    </div>
                </div>
            </div>

            <!-- é£é™©æç¤º -->
            <div class="report-section risk-alerts">
                <h3 class="section-title">
                    <span class="icon">âš¡</span> é£é™©æç¤º
                </h3>
                <div class="alerts-grid">
                    <div v-if="riskAlerts.high.length > 0" class="alert-group alert-high">
                        <strong>â›” é«˜é£é™©é¡¹ï¼š</strong>
                        <ul>
                            <li v-for="(alert, index) in riskAlerts.high" :key="index">{{ alert }}</li>
                        </ul>
                    </div>
                    <div v-if="riskAlerts.medium.length > 0" class="alert-group alert-medium">
                        <strong>âš ï¸ éœ€å…³æ³¨é¡¹ï¼š</strong>
                        <ul>
                            <li v-for="(alert, index) in riskAlerts.medium" :key="index">{{ alert }}</li>
                        </ul>
                    </div>
                    <div v-if="riskAlerts.low.length > 0" class="alert-group alert-low">
                        <strong>â„¹ï¸ ä¸€èˆ¬æç¤ºï¼š</strong>
                        <ul>
                            <li v-for="(alert, index) in riskAlerts.low" :key="index">{{ alert }}</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- å†³ç­–ä¾æ® -->
            <div class="report-section decision-basis">
                <h3 class="section-title">
                    <span class="icon">ğŸ“‹</span> å†³ç­–ä¾æ®
                </h3>
                <div class="basis-content">
                    <div class="basis-item">
                        <strong>æ•°æ®æ¥æºï¼š</strong>
                        <span>{{ decisionBasis.dataSources.join('ã€') }}</span>
                    </div>
                    <div class="basis-item">
                        <strong>æ¨¡å‹ç‰ˆæœ¬ï¼š</strong>
                        <span>{{ decisionBasis.modelVersion }}</span>
                    </div>
                    <div class="basis-item">
                        <strong>AIç½®ä¿¡åº¦ï¼š</strong>
                        <span>{{ decisionBasis.confidence }}%</span>
                    </div>
                </div>
                <div class="disclaimer">
                    <p>âš ï¸ <strong>å…è´£å£°æ˜ï¼š</strong>æœ¬æŠ¥å‘Šç”±AIç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒã€‚æœ€ç»ˆä¿¡å®¡å†³ç­–éœ€ç”±ä¸“ä¸šä¿¡å®¡å‘˜åŸºäºå®Œæ•´ä¿¡æ¯è¿›è¡Œäººå·¥å¤æ ¸å’Œåˆ¤æ–­ã€‚</p>
                </div>
            </div>

            <!-- æŠ¥å‘Šé¡µè„š -->
            <div class="report-footer">
                <p>Â© 2024 å¤§ä¼—æ±½è½¦é‡‘èæœåŠ¡æœ‰é™å…¬å¸ | AIä¿¡å®¡æŠ¥å‘Šç³»ç»Ÿ v1.0</p>
                <p>æœ¬æŠ¥å‘Šä¸ºæœºå¯†æ–‡ä»¶ï¼Œä»…ä¾›å†…éƒ¨ä½¿ç”¨</p>
            </div>
        </div>
    </div>

    <!-- JavaScriptæ–‡ä»¶ -->
    <script src="js/data.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/export.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
