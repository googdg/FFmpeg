<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§ä¼—æ±½è½¦é‡‘è - AIä¿¡å®¡æŠ¥å‘Šç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .toolbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: #001e50;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1000;
        }

        .toolbar h1 {
            font-size: 18px;
            font-weight: 600;
        }

        .toolbar-right {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .case-selector {
            padding: 8px 16px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 4px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 14px;
            cursor: pointer;
        }

        .btn {
            padding: 8px 20px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            background: #00b0f0;
            color: white;
        }

        .btn:hover {
            background: #0099d6;
        }

        .report-container {
            max-width: 1200px;
            margin: 80px auto 40px;
            background: white;
            box-shadow: 0 2px 16px rgba(0,0,0,0.1);
            padding: 32px;
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            padding-bottom: 24px;
            border-bottom: 3px solid #001e50;
            margin-bottom: 32px;
        }

        .header-title h2 {
            font-size: 24px;
            color: #001e50;
            margin-bottom: 8px;
        }

        .report-section {
            margin-bottom: 32px;
            padding: 24px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #001e50;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .overview-item {
            display: flex;
            gap: 8px;
        }

        .overview-item label {
            font-weight: 500;
            color: #666;
            min-width: 80px;
        }

        .risk-score {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 24px auto;
            color: white;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .risk-score.level-a {
            background: linear-gradient(135deg, #00c853, #00e676);
        }

        .risk-score.level-b {
            background: linear-gradient(135deg, #2196f3, #64b5f6);
        }

        .risk-score.level-c {
            background: linear-gradient(135deg, #ffc107, #ffeb3b);
            color: #333;
        }

        .score-value {
            font-size: 48px;
            font-weight: bold;
        }

        .score-label {
            font-size: 14px;
            margin-top: 8px;
        }

        .risk-level {
            font-size: 18px;
            font-weight: 600;
            margin-top: 8px;
            padding: 4px 16px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
        }

        .rag-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .rag-item {
            padding: 16px;
            background: #f5f5f5;
            border-radius: 8px;
        }

        .rag-item strong {
            display: block;
            color: #001e50;
            margin-bottom: 8px;
        }

        .recommendations-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .recommendation-item {
            display: flex;
            gap: 16px;
            padding: 16px;
            background: #f5f5f5;
            border-left: 4px solid #ff9800;
            border-radius: 4px;
        }

        .recommendation-number {
            width: 32px;
            height: 32px;
            background: #001e50;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .highlight {
            color: #0066cc;
            font-weight: 600;
            font-size: 16px;
        }

        .decision-approve {
            background: #e8f5e9 !important;
            border-left: 4px solid #00c853 !important;
        }

        .decision-conditional {
            background: #fff3e0 !important;
            border-left: 4px solid #ffc107 !important;
        }

        .decision-reject {
            background: #ffebee !important;
            border-left: 4px solid #f44336 !important;
        }

        .question-count {
            font-size: 13px;
            color: #666;
            font-weight: normal;
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å·¥å…·æ  -->
    <div class="toolbar">
        <h1>ğŸš— å¤§ä¼—æ±½è½¦é‡‘è - AIä¿¡å®¡æŠ¥å‘Šç³»ç»Ÿ</h1>
        <div class="toolbar-right">
            <select class="case-selector" onchange="switchCase(this.value)" id="caseSelector">
                <option value="case1">æ¡ˆä¾‹1 - ä¼˜è´¨å®¢æˆ·(Açº§)</option>
                <option value="case2" selected>æ¡ˆä¾‹2 - è‰¯å¥½å®¢æˆ·(Bçº§)</option>
                <option value="case3">æ¡ˆä¾‹3 - ä¸€èˆ¬å®¢æˆ·(Cçº§)</option>
            </select>
            <button class="btn" onclick="window.print()">ğŸ–¨ï¸ æ‰“å°æŠ¥å‘Š</button>
            <button class="btn" onclick="exportToPDF()" id="exportBtn">ğŸ“„ å¯¼å‡ºPDF</button>
        </div>
    </div>

    <!-- ä¸»æŠ¥å‘Šå†…å®¹ -->
    <div class="report-container">
        <!-- æŠ¥å‘Šå¤´éƒ¨ -->
        <div class="report-header">
            <div class="header-title">
                <h2>å¤§ä¼—æ±½è½¦é‡‘è</h2>
                <p>AIæ™ºèƒ½ä¿¡å®¡æŠ¥å‘Š</p>
            </div>
            <div>
                <p><strong>æŠ¥å‘Šæ—¥æœŸï¼š</strong>2024-11-12</p>
                <p><strong>æŠ¥å‘Šç¼–å·ï¼š</strong>CA20241112001</p>
            </div>
        </div>

        <!-- å®¢æˆ·æ¦‚è§ˆ -->
        <div class="report-section">
            <h3 class="section-title">ğŸ‘¤ å®¢æˆ·æ¦‚è§ˆ</h3>
            <div class="overview-grid">
                <div class="overview-item">
                    <label>å§“åï¼š</label>
                    <span>å¼ **</span>
                </div>
                <div class="overview-item">
                    <label>æ€§åˆ«ï¼š</label>
                    <span>ç”·</span>
                </div>
                <div class="overview-item">
                    <label>å¹´é¾„ï¼š</label>
                    <span>35å²</span>
                </div>
                <div class="overview-item">
                    <label>ç”³è¯·äº§å“ï¼š</label>
                    <span>æ–°è½¦è´·æ¬¾</span>
                </div>
                <div class="overview-item">
                    <label>ç”³è¯·é‡‘é¢ï¼š</label>
                    <span class="highlight">Â¥300,000</span>
                </div>
                <div class="overview-item">
                    <label>è´·æ¬¾æœŸé™ï¼š</label>
                    <span>36æœŸ</span>
                </div>
            </div>
        </div>

        <!-- é£é™©è¯„ä¼° -->
        <div class="report-section">
            <h3 class="section-title">âš ï¸ é£é™©è¯„ä¼°</h3>
            <div class="risk-score">
                <div class="score-value">720</div>
                <div class="score-label">ç»¼åˆè¯„åˆ†</div>
                <div class="risk-level">è‰¯å¥½å®¢æˆ·</div>
            </div>
            <p style="text-align: center; color: #666;">
                DSR: 42% | LTV: 75% | æœˆæ”¶å…¥: Â¥22,000 | å¾ä¿¡åˆ†: 690
            </p>
        </div>

        <!-- RAGæ™ºèƒ½æ±‡æ€» -->
        <div class="report-section">
            <h3 class="section-title">ğŸ¤– AIæ™ºèƒ½ä¿¡æ¯æ±‡æ€» <span style="font-size: 11px; background: #00b0f0; color: white; padding: 2px 8px; border-radius: 12px; font-weight: normal;">RAGæŠ€æœ¯</span></h3>
            <div class="rag-grid">
                <div class="rag-item">
                    <strong>ğŸ“Š è´¢æŠ¥æ‘˜è¦ï¼š</strong>
                    <p>ä¼ä¸šè¥æ”¶ç¨³å®šå¢é•¿ï¼Œè¿‘ä¸‰å¹´å¹´å‡å¢é•¿ç‡15%ï¼Œç°é‡‘æµå……è£•</p>
                </div>
                <div class="rag-item">
                    <strong>ğŸ” ç¬¬ä¸‰æ–¹æ•°æ®ï¼š</strong>
                    <p>å¾ä¿¡è®°å½•è‰¯å¥½ï¼Œæ— é€¾æœŸï¼Œç¤¾ä¿å…¬ç§¯é‡‘è¿ç»­ç¼´çº³36ä¸ªæœˆ</p>
                </div>
                <div class="rag-item">
                    <strong>ğŸ“° èˆ†æƒ…ç›‘æµ‹ï¼š</strong>
                    <p>æœªå‘ç°è´Ÿé¢ä¿¡æ¯ï¼Œè¡Œä¸šå‘å±•å¹³ç¨³ï¼Œä¼ä¸šè¿è¥æ­£å¸¸</p>
                </div>
            </div>
        </div>

        <!-- AIå»ºè®®å®¡æ ¸æ–¹å‘ -->
        <div class="report-section">
            <h3 class="section-title">ğŸ¯ AIå»ºè®®å®¡æ ¸æ–¹å‘</h3>
            <div class="recommendations-list">
                <div class="recommendation-item">
                    <div class="recommendation-number">1</div>
                    <div>
                        <p>è´Ÿå€ºç‡åé«˜(42%)ï¼Œéœ€é‡ç‚¹æ ¸å®å…¶ä»–è´·æ¬¾çš„çœŸå®æƒ…å†µå’Œæœˆä¾›é‡‘é¢</p>
                    </div>
                </div>
                <div class="recommendation-item">
                    <div class="recommendation-number">2</div>
                    <div>
                        <p>å·¥ä½œå¹´é™è¾ƒçŸ­(3å¹´)ï¼Œå»ºè®®è¯„ä¼°æ”¶å…¥ç¨³å®šæ€§å’ŒèŒä¸šå‘å±•å‰æ™¯</p>
                    </div>
                </div>
                <div class="recommendation-item">
                    <div class="recommendation-number">3</div>
                    <div>
                        <p>é¦–æ¬¡è´­è½¦ï¼Œéœ€äº†è§£è´­è½¦ç”¨é€”å’Œè¯¦ç»†çš„è¿˜æ¬¾è®¡åˆ’</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- å®¡æ‰¹å»ºè®® -->
        <div class="report-section">
            <h3 class="section-title">âœ… å®¡æ‰¹å»ºè®®</h3>
            <div style="padding: 16px; background: #fff3e0; border-radius: 8px; border-left: 4px solid #ffc107;">
                <p style="font-size: 18px; font-weight: 600; margin-bottom: 16px;">
                    å»ºè®®å†³ç­–ï¼š<span style="color: #ff9800;">âš ï¸ æœ‰æ¡ä»¶æ‰¹å‡†</span>
                </p>
                <p><strong>å»ºè®®é¢åº¦ï¼š</strong>Â¥200,000 - Â¥250,000</p>
                <p><strong>å»ºè®®åˆ©ç‡ï¼š</strong>4.5% - 5.5%</p>
                <p><strong>é¢„æœŸè¿çº¦ç‡ï¼š</strong>1.8%</p>
                <p style="margin-top: 16px;"><strong>é™„åŠ æ¡ä»¶ï¼š</strong></p>
                <ul style="margin-left: 20px; margin-top: 8px;">
                    <li>å»ºè®®é™ä½è´·æ¬¾é‡‘é¢è‡³20ä¸‡å…ƒï¼Œä»¥é™ä½æœˆä¾›å‹åŠ›</li>
                    <li>éœ€æä¾›é¢å¤–çš„æ”¶å…¥è¯æ˜æˆ–èµ„äº§è¯æ˜</li>
                    <li>å»ºè®®å¢åŠ é¦–ä»˜æ¯”ä¾‹è‡³40%ä»¥ä¸Š</li>
                </ul>
            </div>
        </div>

        <!-- AIè¾…åŠ©æé—® -->
        <div class="report-section">
            <h3 class="section-title">ğŸ’¬ AIè¾…åŠ©æé—® <span style="font-size: 13px; color: #666; font-weight: normal;">(5ä¸ªå»ºè®®é—®é¢˜)</span></h3>
            <div style="padding: 16px; background: #e8f5e9; border-radius: 8px;">
                <p style="margin-bottom: 12px;"><strong>Q1:</strong> æ‚¨ç›®å‰åä¸‹å…¶ä»–è´·æ¬¾çš„æœˆä¾›æ€»é¢æ˜¯å¤šå°‘ï¼Ÿ</p>
                <p style="margin-bottom: 12px;"><strong>Q2:</strong> æ‚¨çš„æ”¶å…¥æ¥æºæ˜¯å¦ç¨³å®šï¼Ÿæ˜¯å¦æœ‰å…¶ä»–æ”¶å…¥æ¥æºï¼Ÿ</p>
                <p style="margin-bottom: 12px;"><strong>Q3:</strong> é™¤äº†å·¥èµ„æ”¶å…¥ï¼Œæ‚¨æ˜¯å¦æœ‰å…¶ä»–èµ„äº§æˆ–æ”¶å…¥å¯ä»¥ç”¨äºè¿˜æ¬¾ï¼Ÿ</p>
                <p style="margin-bottom: 12px;"><strong>Q4:</strong> è¯·è¯´æ˜æ‚¨çš„è´­è½¦ç”¨é€”å’Œè¿˜æ¬¾è®¡åˆ’ï¼Ÿ</p>
                <p><strong>Q5:</strong> æ‚¨ç›®å‰çš„å·¥ä½œæ˜¯å¦ç¨³å®šï¼Ÿæœªæ¥æ˜¯å¦æœ‰æ™‹å‡æˆ–åŠ è–ªè®¡åˆ’ï¼Ÿ</p>
            </div>
        </div>

        <!-- å†³ç­–ä¾æ® -->
        <div class="report-section">
            <h3 class="section-title">ğŸ“‹ å†³ç­–ä¾æ®</h3>
            <p><strong>æ•°æ®æ¥æºï¼š</strong>CRMç³»ç»Ÿã€äººè¡Œå¾ä¿¡ã€ç¤¾ä¿å…¬ç§¯é‡‘ã€é“¶è¡Œæµæ°´</p>
            <p><strong>æ¨¡å‹ç‰ˆæœ¬ï¼š</strong>v2.1.0</p>
            <p><strong>AIç½®ä¿¡åº¦ï¼š</strong>85%</p>
            <div style="margin-top: 16px; padding: 12px; background: #fff9c4; border-radius: 4px;">
                <p style="font-size: 13px;">âš ï¸ <strong>å…è´£å£°æ˜ï¼š</strong>æœ¬æŠ¥å‘Šç”±AIç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒã€‚æœ€ç»ˆä¿¡å®¡å†³ç­–éœ€ç”±ä¸“ä¸šä¿¡å®¡å‘˜åŸºäºå®Œæ•´ä¿¡æ¯è¿›è¡Œäººå·¥å¤æ ¸å’Œåˆ¤æ–­ã€‚</p>
            </div>
        </div>

        <!-- æŠ¥å‘Šé¡µè„š -->
        <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #e0e0e0; text-align: center; color: #999; font-size: 12px;">
            <p>Â© 2024 å¤§ä¼—æ±½è½¦é‡‘èæœåŠ¡æœ‰é™å…¬å¸ | AIä¿¡å®¡æŠ¥å‘Šç³»ç»Ÿ v1.0</p>
            <p>æœ¬æŠ¥å‘Šä¸ºæœºå¯†æ–‡ä»¶ï¼Œä»…ä¾›å†…éƒ¨ä½¿ç”¨</p>
        </div>
    </div>

    <!-- html2pdf.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script>
        console.log('âœ… å¤§ä¼—æ±½è½¦é‡‘èAIä¿¡å®¡æŠ¥å‘Šç³»ç»Ÿå·²åŠ è½½');
        console.log('ğŸ“Š å½“å‰å±•ç¤ºï¼šæ¡ˆä¾‹2 - è‰¯å¥½å®¢æˆ·(Bçº§)');

        // æ¡ˆä¾‹æ•°æ®
        const cases = {
            case1: {
                name: 'å¼ **',
                gender: 'ç”·',
                age: 35,
                product: 'æ–°è½¦è´·æ¬¾',
                amount: '300,000',
                term: 36,
                vehicle: 'å¤§ä¼—é€”è§‚L 2024æ¬¾ 380TSI',
                reportNumber: 'CA20241112001',
                score: 850,
                level: 'ä¼˜è´¨å®¢æˆ·',
                levelClass: 'level-a',
                dsr: 28,
                ltv: 65,
                income: '35,000',
                creditScore: 780,
                overdue: 0,
                ragFinancial: 'ä¼ä¸šè¥æ”¶ç¨³å®šå¢é•¿ï¼Œè¿‘ä¸‰å¹´å¹´å‡å¢é•¿ç‡15%ï¼Œç°é‡‘æµå……è£•ï¼Œèµ„äº§è´Ÿå€ºç‡å¥åº·',
                ragThirdParty: 'å¾ä¿¡è®°å½•ä¼˜ç§€ï¼Œæ— é€¾æœŸè®°å½•ï¼Œç¤¾ä¿å…¬ç§¯é‡‘è¿ç»­ç¼´çº³60ä¸ªæœˆï¼Œæ”¶å…¥ç¨³å®šå¯é ',
                ragSentiment: 'æœªå‘ç°è´Ÿé¢æ–°é—»ï¼Œæ‰€åœ¨è¡Œä¸šå‘å±•ç¨³å®šï¼Œä¼ä¸šä¿¡èª‰è‰¯å¥½ï¼Œæ— å¸æ³•è¯‰è®¼è®°å½•',
                recommendations: [
                    'å®¢æˆ·èµ„è´¨ä¼˜ç§€ï¼Œå»ºè®®å¿«é€Ÿå®¡æ‰¹é€šè¿‡ï¼Œå¯ä½œä¸ºä¼˜è´¨å®¢æˆ·é‡ç‚¹ç»´æŠ¤',
                    'æ”¶å…¥ç¨³å®šä¸”è´Ÿå€ºç‡ä½ï¼Œå»ºè®®æä¾›ä¼˜æƒ åˆ©ç‡ä»¥å¢å¼ºå®¢æˆ·ç²˜æ€§',
                    'å¯æ¨èå…¶ä»–é‡‘èäº§å“ï¼Œå¦‚ä¿¡ç”¨å¡ã€ç†è´¢ç­‰å¢å€¼æœåŠ¡'
                ],
                decision: 'âœ… æ‰¹å‡†',
                decisionClass: 'decision-approve',
                loanRange: 'Â¥300,000 - Â¥350,000',
                rateRange: '3.5% - 4.0%',
                defaultRate: '0.3%',
                conditions: [],
                questions: [
                    { q: 'è¯·é—®æ‚¨é€‰æ‹©è¿™æ¬¾è½¦å‹çš„ä¸»è¦è€ƒè™‘å› ç´ æ˜¯ä»€ä¹ˆï¼Ÿ', cat: 'è´­è½¦è®¡åˆ’' },
                    { q: 'æ‚¨è®¡åˆ’ä½¿ç”¨å“ªä¸ªè´¦æˆ·è¿›è¡Œæœˆä¾›è¿˜æ¬¾ï¼Ÿ', cat: 'è¿˜æ¬¾è®¡åˆ’' },
                    { q: 'æ˜¯å¦éœ€è¦äº†è§£æˆ‘ä»¬çš„è½¦è¾†ä¿é™©å’Œå»¶ä¿æœåŠ¡ï¼Ÿ', cat: 'å¢å€¼æœåŠ¡' }
                ]
            },
            case2: {
                name: 'æ**',
                gender: 'å¥³',
                age: 32,
                product: 'æ–°è½¦è´·æ¬¾',
                amount: '250,000',
                term: 36,
                vehicle: 'å¤§ä¼—å¸•è¨ç‰¹ 2024æ¬¾ 330TSI',
                reportNumber: 'CA20241112002',
                score: 720,
                level: 'è‰¯å¥½å®¢æˆ·',
                levelClass: 'level-b',
                dsr: 42,
                ltv: 75,
                income: '22,000',
                creditScore: 690,
                overdue: 0,
                ragFinancial: 'ä¼ä¸šç»è¥ç¨³å®šï¼Œè¥æ”¶ç•¥æœ‰æ³¢åŠ¨ä½†æ•´ä½“å‘å¥½ï¼Œç°é‡‘æµåŸºæœ¬æ»¡è¶³éœ€æ±‚',
                ragThirdParty: 'å¾ä¿¡è®°å½•è‰¯å¥½ï¼Œæ— é€¾æœŸï¼Œç¤¾ä¿å…¬ç§¯é‡‘è¿ç»­ç¼´çº³36ä¸ªæœˆï¼Œæ”¶å…¥æ¥æºç¨³å®š',
                ragSentiment: 'æœªå‘ç°é‡å¤§è´Ÿé¢ä¿¡æ¯ï¼Œè¡Œä¸šå‘å±•å¹³ç¨³ï¼Œä¼ä¸šè¿è¥æ­£å¸¸',
                recommendations: [
                    'è´Ÿå€ºç‡åé«˜(42%)ï¼Œéœ€é‡ç‚¹æ ¸å®å…¶ä»–è´·æ¬¾çš„çœŸå®æƒ…å†µå’Œæœˆä¾›é‡‘é¢',
                    'å·¥ä½œå¹´é™è¾ƒçŸ­(3å¹´)ï¼Œå»ºè®®è¯„ä¼°æ”¶å…¥ç¨³å®šæ€§å’ŒèŒä¸šå‘å±•å‰æ™¯',
                    'é¦–æ¬¡è´­è½¦ï¼Œéœ€äº†è§£è´­è½¦ç”¨é€”å’Œè¯¦ç»†çš„è¿˜æ¬¾è®¡åˆ’'
                ],
                decision: 'âš ï¸ æœ‰æ¡ä»¶æ‰¹å‡†',
                decisionClass: 'decision-conditional',
                loanRange: 'Â¥200,000 - Â¥250,000',
                rateRange: '4.5% - 5.5%',
                defaultRate: '1.8%',
                conditions: [
                    'å»ºè®®é™ä½è´·æ¬¾é‡‘é¢è‡³20ä¸‡å…ƒï¼Œä»¥é™ä½æœˆä¾›å‹åŠ›',
                    'éœ€æä¾›é¢å¤–çš„æ”¶å…¥è¯æ˜æˆ–èµ„äº§è¯æ˜',
                    'å»ºè®®å¢åŠ é¦–ä»˜æ¯”ä¾‹è‡³40%ä»¥ä¸Š'
                ],
                questions: [
                    { q: 'æ‚¨ç›®å‰åä¸‹å…¶ä»–è´·æ¬¾çš„æœˆä¾›æ€»é¢æ˜¯å¤šå°‘ï¼Ÿ', cat: 'è´Ÿå€ºæƒ…å†µ' },
                    { q: 'æ‚¨çš„æ”¶å…¥æ¥æºæ˜¯å¦ç¨³å®šï¼Ÿæ˜¯å¦æœ‰å…¶ä»–æ”¶å…¥æ¥æºï¼Ÿ', cat: 'æ”¶å…¥æ¥æº' },
                    { q: 'é™¤äº†å·¥èµ„æ”¶å…¥ï¼Œæ‚¨æ˜¯å¦æœ‰å…¶ä»–èµ„äº§æˆ–æ”¶å…¥å¯ä»¥ç”¨äºè¿˜æ¬¾ï¼Ÿ', cat: 'è¿˜æ¬¾èƒ½åŠ›' },
                    { q: 'è¯·è¯´æ˜æ‚¨çš„è´­è½¦ç”¨é€”å’Œè¿˜æ¬¾è®¡åˆ’ï¼Ÿ', cat: 'è´­è½¦ç”¨é€”' },
                    { q: 'æ‚¨ç›®å‰çš„å·¥ä½œæ˜¯å¦ç¨³å®šï¼Ÿæœªæ¥æ˜¯å¦æœ‰æ™‹å‡æˆ–åŠ è–ªè®¡åˆ’ï¼Ÿ', cat: 'èŒä¸šå‘å±•' }
                ]
            },
            case3: {
                name: 'ç‹**',
                gender: 'ç”·',
                age: 28,
                product: 'äºŒæ‰‹è½¦è´·æ¬¾',
                amount: '150,000',
                term: 24,
                vehicle: 'å¤§ä¼—è¿ˆè…¾ 2021æ¬¾ 330TSI',
                reportNumber: 'CA20241112003',
                score: 580,
                level: 'ä¸€èˆ¬å®¢æˆ·',
                levelClass: 'level-c',
                dsr: 55,
                ltv: 85,
                income: '15,000',
                creditScore: 620,
                overdue: 2,
                ragFinancial: 'æ”¶å…¥æ°´å¹³ä¸€èˆ¬ï¼Œå­˜åœ¨ä¸€å®šæ³¢åŠ¨ï¼Œå‚¨è“„è¾ƒå°‘ï¼ŒæŠ—é£é™©èƒ½åŠ›æœ‰é™',
                ragThirdParty: 'å¾ä¿¡è®°å½•ä¸€èˆ¬ï¼Œå­˜åœ¨2æ¬¡é€¾æœŸè®°å½•(å·²ç»“æ¸…)ï¼Œç¤¾ä¿ç¼´çº³18ä¸ªæœˆ',
                ragSentiment: 'æœªå‘ç°é‡å¤§è´Ÿé¢ä¿¡æ¯ï¼Œä½†æ‰€åœ¨è¡Œä¸šç«äº‰æ¿€çƒˆï¼Œå°±ä¸šç¨³å®šæ€§ä¸€èˆ¬',
                recommendations: [
                    'è´Ÿå€ºç‡è¿‡é«˜(55%)ï¼Œä¸¥é‡è¶…æ ‡ï¼Œéœ€è¯¦ç»†æ ¸å®æ‰€æœ‰è´Ÿå€ºæƒ…å†µ',
                    'å­˜åœ¨é€¾æœŸè®°å½•ï¼Œéœ€äº†è§£é€¾æœŸåŸå› å’Œå½“å‰è¿˜æ¬¾èƒ½åŠ›æ”¹å–„æƒ…å†µ',
                    'LTVæ¯”ä¾‹è¿‡é«˜(85%)ï¼Œå»ºè®®è¦æ±‚å¢åŠ é¦–ä»˜æˆ–é™ä½è´·æ¬¾é‡‘é¢',
                    'å·¥ä½œç¨³å®šæ€§è¾ƒå·®ï¼Œéœ€è¯„ä¼°èŒä¸šå‰æ™¯å’Œæ”¶å…¥å¢é•¿æ½œåŠ›'
                ],
                decision: 'âš ï¸ æœ‰æ¡ä»¶æ‰¹å‡†',
                decisionClass: 'decision-conditional',
                loanRange: 'Â¥100,000 - Â¥120,000',
                rateRange: '6.0% - 7.5%',
                defaultRate: '4.2%',
                conditions: [
                    'å¿…é¡»é™ä½è´·æ¬¾é‡‘é¢è‡³12ä¸‡å…ƒä»¥ä¸‹',
                    'å¿…é¡»æä¾›æœ‰æ•ˆæ‹…ä¿äººæˆ–æŠµæŠ¼ç‰©',
                    'éœ€è¦æä¾›é¢å¤–çš„æ”¶å…¥è¯æ˜å’Œèµ„äº§è¯æ˜',
                    'å»ºè®®ç¼©çŸ­è´·æ¬¾æœŸé™è‡³18ä¸ªæœˆ',
                    'éœ€è¦ä¸»ç®¡çº§åˆ«å®¡æ‰¹'
                ],
                questions: [
                    { q: 'è¯·è¯¦ç»†è¯´æ˜æ‚¨ä¹‹å‰ä¸¤æ¬¡é€¾æœŸçš„å…·ä½“åŸå› ï¼Ÿ', cat: 'é€¾æœŸåŸå› ' },
                    { q: 'è¯·åˆ—å‡ºæ‚¨ç›®å‰æ‰€æœ‰çš„è´·æ¬¾å’Œä¿¡ç”¨å¡è´Ÿå€ºæ˜ç»†ï¼Ÿ', cat: 'è´Ÿå€ºæƒ…å†µ' },
                    { q: 'æ‚¨ç›®å‰çš„æœˆæ”¶å…¥æ˜¯å¦è¶³ä»¥è¦†ç›–æ‰€æœ‰æœˆä¾›ï¼Ÿ', cat: 'è¿˜æ¬¾èƒ½åŠ›' },
                    { q: 'æ‚¨æ˜¯å¦æœ‰æˆ¿äº§ã€å­˜æ¬¾æˆ–å…¶ä»–èµ„äº§å¯ä»¥ä½œä¸ºè¿˜æ¬¾ä¿éšœï¼Ÿ', cat: 'èµ„äº§æƒ…å†µ' },
                    { q: 'æ˜¯å¦å¯ä»¥æä¾›æœ‰ç¨³å®šæ”¶å…¥çš„æ‹…ä¿äººï¼Ÿ', cat: 'æ‹…ä¿äºº' }
                ]
            }
        };

        // å½“å‰æ¡ˆä¾‹
        let currentCase = 'case2';

        // åˆ‡æ¢æ¡ˆä¾‹
        function switchCase(caseId) {
            currentCase = caseId;
            const data = cases[caseId];
            
            // æ›´æ–°æ‰€æœ‰æ•°æ®
            document.querySelector('.report-header .header-title + div p:last-child strong + span').textContent = data.reportNumber;
            
            // å®¢æˆ·æ¦‚è§ˆ
            const overviewItems = document.querySelectorAll('.overview-item span:last-child');
            overviewItems[0].textContent = data.name;
            overviewItems[1].textContent = data.gender;
            overviewItems[2].textContent = data.age + 'å²';
            overviewItems[3].textContent = data.product;
            overviewItems[4].textContent = 'Â¥' + data.amount;
            overviewItems[5].textContent = data.term + 'æœŸ';
            
            // é£é™©è¯„åˆ†
            const riskScore = document.querySelector('.risk-score');
            riskScore.className = 'risk-score ' + data.levelClass;
            riskScore.querySelector('.score-value').textContent = data.score;
            riskScore.querySelector('.risk-level').textContent = data.level;
            
            // å…³é”®æŒ‡æ ‡
            document.querySelector('.risk-score + p').innerHTML = 
                `DSR: ${data.dsr}% | LTV: ${data.ltv}% | æœˆæ”¶å…¥: Â¥${data.income} | å¾ä¿¡åˆ†: ${data.creditScore} | é€¾æœŸ: ${data.overdue}æ¬¡`;
            
            // RAGæ±‡æ€»
            const ragItems = document.querySelectorAll('.rag-item p');
            ragItems[0].textContent = data.ragFinancial;
            ragItems[1].textContent = data.ragThirdParty;
            ragItems[2].textContent = data.ragSentiment;
            
            // AIå»ºè®®
            const recList = document.querySelector('.recommendations-list');
            recList.innerHTML = data.recommendations.map((rec, i) => `
                <div class="recommendation-item">
                    <div class="recommendation-number">${i + 1}</div>
                    <div><p>${rec}</p></div>
                </div>
            `).join('');
            
            // å®¡æ‰¹å»ºè®®
            const decisionSection = document.querySelector('.report-section:nth-of-type(6) > div');
            decisionSection.className = data.decisionClass;
            decisionSection.querySelector('p:first-child span').textContent = data.decision;
            decisionSection.querySelectorAll('p')[1].innerHTML = `<strong>å»ºè®®é¢åº¦ï¼š</strong>${data.loanRange}`;
            decisionSection.querySelectorAll('p')[2].innerHTML = `<strong>å»ºè®®åˆ©ç‡ï¼š</strong>${data.rateRange}`;
            decisionSection.querySelectorAll('p')[3].innerHTML = `<strong>é¢„æœŸè¿çº¦ç‡ï¼š</strong>${data.defaultRate}`;
            
            // æ¡ä»¶
            if (data.conditions.length > 0) {
                if (!decisionSection.querySelector('ul')) {
                    decisionSection.innerHTML += `
                        <p style="margin-top: 16px;"><strong>é™„åŠ æ¡ä»¶ï¼š</strong></p>
                        <ul style="margin-left: 20px; margin-top: 8px;"></ul>
                    `;
                }
                decisionSection.querySelector('ul').innerHTML = data.conditions.map(c => `<li>${c}</li>`).join('');
            } else {
                const ul = decisionSection.querySelector('ul');
                if (ul) ul.parentElement.remove();
            }
            
            // AIè¾…åŠ©æé—®
            const questionsDiv = document.querySelector('.report-section:nth-of-type(7) > div');
            questionsDiv.innerHTML = data.questions.map((q, i) => 
                `<p style="margin-bottom: 12px;"><strong>Q${i + 1} [${q.cat}]:</strong> ${q.q}</p>`
            ).join('');
            
            // æ›´æ–°æ ‡é¢˜ä¸­çš„é—®é¢˜æ•°é‡
            document.querySelector('.section-title .question-count').textContent = `(${data.questions.length}ä¸ªå»ºè®®é—®é¢˜)`;
            
            console.log(`âœ… å·²åˆ‡æ¢åˆ°ï¼š${caseId} - ${data.level}`);
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', () => {
            switchCase(currentCase);
        });

        // PDFå¯¼å‡ºåŠŸèƒ½
        function exportToPDF() {
            const button = document.getElementById('exportBtn');
            const originalText = button.innerHTML;
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            button.innerHTML = 'â³ ç”Ÿæˆä¸­...';
            button.disabled = true;
            
            // è·å–æŠ¥å‘Šå®¹å™¨
            const element = document.querySelector('.report-container');
            
            // é…ç½®é€‰é¡¹
            const opt = {
                margin: [10, 10, 10, 10],
                filename: 'VWä¿¡å®¡æŠ¥å‘Š_' + new Date().getTime() + '.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    letterRendering: true
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait' 
                },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
            };
            
            // ç”ŸæˆPDF
            html2pdf()
                .set(opt)
                .from(element)
                .save()
                .then(() => {
                    // æ¢å¤æŒ‰é’®çŠ¶æ€
                    button.innerHTML = originalText;
                    button.disabled = false;
                    alert('âœ… PDFå¯¼å‡ºæˆåŠŸï¼');
                })
                .catch((error) => {
                    console.error('PDFå¯¼å‡ºå¤±è´¥:', error);
                    button.innerHTML = originalText;
                    button.disabled = false;
                    alert('âŒ PDFå¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•');
                });
        }
    </script>
</body>
</html>
